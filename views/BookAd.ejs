<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="/Advertisement-Images/favicon.ico">
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CVarela+Round" rel="stylesheet">
<link rel="stylesheet" href="/fontawesome-free-5.13.0-web/css/fontawesome.min.css">
<link rel="stylesheet" href="/font-awesome-4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/Header-CSS/header.css">
<link rel="stylesheet" href="/Header-CSS/headerMobile.css">
<link rel="stylesheet" href="/Advertisement-CSS/BookAd.css">
<link rel="stylesheet" href="/Advertisement-CSS/Book AdMobile.css">
<title>Kopa Booka | Ad Board</title>
</head>
<body>

	<%- include("partials/header"); -%>

  <section id="Search-results-cont">
	  <div class="categories-cont closeList" id="categories-cont">
			<div class="all-categories" id="all-categories">
				<div class="category clicker" id="closeOpen-list">
					<h4 class="category-title">Catagory</h4>
					<i class="fa fa-caret-down switch-arrow"></i>
				</div>
				<ul class="faculty" id="facultyLists">
					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Art Design and Architecture</span>
							<i class="faculty-arrow fa fa-caret-down" ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Architecture</li>
							<li class="department-link">Fashion</li>
							<li class="department-link">Graphic Design</li>
							<li class="department-link">Industrial Design</li>
							<li class="department-link">Interior Design</li>
							<li class="department-link">Jewel Design & Manufacture</li>
							<li class="department-link">Multimedia</li>
							<li class="department-link">Visual Art</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">College of Business and Economics</span>
							<i class="faculty-arrow fa fa-caret-down" ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Applied Information Systems</li>
							<li class="department-link">Accountancy</li>
							<li class="department-link">Business Management</li>
							<li class="department-link">Finance & Investment Management</li>
							<li class="department-link">Industrial Psychology & People Management</li>
							<li class="department-link">Information & Knowledge Management</li>
							<li class="department-link">Marketing Management</li>
							<li class="department-link">Transport & Supply Chain Management</li>
							<li class="department-link">Economics</li>
							<li class="department-link">Public Management</li>
							<li class="department-link">Governance & Public Policy</li>
							<li class="department-link">Tourism & Hospitality</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Education</span>
							<i class="faculty-arrow fa fa-caret-down" ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Childhood Education</li>
							<li class="department-link">Education & Curriculum Studies</li>
							<li class="department-link">Education Leadership & Management</li>
							<li class="department-link">Educational Psychology</li>
							<li class="department-link">Science & Technology Education</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Engineering and Built Environment</span>
							<i class="faculty-arrow fa fa-caret-down " ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Chemical Engineering Technology</li>
							<li class="department-link">Civil Engineering</li>
							<li class="department-link">Construction Management & Quantity Survey</li>
							<li class="department-link">Electric Engineering</li>
							<li class="department-link">Mechanical Engineering</li>
							<li class="department-link">Metallurgy</li>
							<li class="department-link">Mine Surveying</li>
							<li class="department-link">Mining</li>
							<li class="department-link">Quality & Operation Management</li>
							<li class="department-link">Town & Regional Planning</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Health Sciences</span>
							<i class="faculty-arrow fa fa-caret-down " ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Biomedical Technology</li>
							<li class="department-link">Chiropractic</li>
							<li class="department-link">Emergency Medical Care</li>
							<li class="department-link">Environmental Health</li>
							<li class="department-link">Homoeopathy</li>
							<li class="department-link">Human Anatomy & Physiology</li>
							<li class="department-link">Nursing</li>
							<li class="department-link">Optometry</li>
							<li class="department-link">Podiatry</li>
							<li class="department-link">Radiography</li>
							<li class="department-link">Somatology</li>
							<li class="department-link">Sport & Movement Studies</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Humanities</span>
							<i class="faculty-arrow fa fa-caret-down" ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">African Languages</li>
							<li class="department-link">Afrikaans</li>
							<li class="department-link">Anthropology & Development Studies</li>
							<li class="department-link">Communication Studies</li>
							<li class="department-link">English</li>
							<li class="department-link">French</li>
							<li class="department-link">Greek & Latin Studies</li>
							<li class="department-link">Historical Studie</li>
							<li class="department-link">Journalism, Film & Television</li>
							<li class="department-link">Linguistics</li>
							<li class="department-link">Philosophy</li>
							<li class="department-link">Politics & International Relation</li>
							<li class="department-link">Religion Studies</li>
							<li class="department-link">Social Work</li>
							<li class="department-link">Sociology</li>
							<li class="department-link">Strategic Communication</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Law</span>
							<i class="faculty-arrow fa fa-caret-down" ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Mercantile Law</li>
							<li class="department-link">Private Law</li>
							<li class="department-link">Public Law</li>
						</ul>
					</li>

					<li class="faculty-list">
						<div class="faculty-title clicker">
							<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Science</span>
							<i class="faculty-arrow fa fa-caret-down" ></i>
						</div>
						<ul class="department-list">
							<li class="department-link">Computer Science</li>
							<li class="department-link">Applied Physics & Engineering Mathematics</li>
							<li class="department-link">Biochemistry</li>
							<li class="department-link">Biotechnology & Food Technology</li>
							<li class="department-link">Botany & Plant Biotechnology</li>
							<li class="department-link">Chemistry</li>
							<li class="department-link">Geography,Environmental Management</li>
							<li class="department-link">Physics</li>
							<li class="department-link">Applied Mathematics</li>
							<li class="department-link">Statistics</li>
							<li class="department-link">Zoology</li>
						</ul>
					</li>
				</ul>

				<div class="category clicker">
					<h4 class="arrow category-title"><span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Campus</span></h4>
					<i class="fa fa-caret-down"></i>
				</div>

				<ul class="campus-options" id="CampusList">
					<li class="campusOptions-link">Any Campus</li>
					<li class="campusOptions-link">Auckland Park Campus</li>
					<li class="campusOptions-link">Bunting Campus</li>
					<li class="campusOptions-link">Soweto Campus</li>
					<li class="campusOptions-link">Doornfontein Campus</li>
				</ul>
			</div>
		</div>

	  <div class="advertisements">
		<%	let { searchQuery } = req.params; %>
			<div class="Ad-title">
		  <% if(Object.keys(req.params).length === 0) { %>
				<h1><b>All Ads</b> on Kopa-Booka</h1>
		  <% } else { %>
				<h1><b>"<%= `${searchQuery}` %>"</b> Ads on Kopa-Booka</h1>
		  <% } %>
			</div>
			<div class="search-engine">
				<div class="searcher">
					<button type="submit" class="but search-btn" id="search-btn"><i class="fa fa-search fa-fw search-btn"></i></button>
					<input type="text" class="search" id="searcher" name="search-engine" placeholder="Search for textbook title...">
				</div>
			</div>
			
		<%	if(notFound === false){ %>
				<div class="AdTracker-SortByDiv">
					<div class="AdTracker-TotalNum">
						<p class="AdTrackerNum"> <b>1</b> to <b><%= numOfCurrentAds %></b> of <b><%= totalAmountOfAds %></b> Ads</p>
					</div>
					<div class="SortBy-List">
						<button class="SortBy-Btn icon" id="SortBy-Btn">
							<span class="icon">Sort by</span><i class="fa fa-caret-up icon" id="collapser"></i>
						</button>
						<ul class="Sort-List" id="Sort-List">
							<li class="SortList-link icon"><i class="fa fa-star-o fa-fw icon"></i>Latest Ads</li>
							<li class="SortList-link icon"><i class="fa fa-arrow-circle-o-up fa-fw icon"></i>Price Low to High</li>
							<li class="SortList-link icon"><i class="fa fa-arrow-circle-o-down fa-fw icon"></i>Price High to Low</li>
						</ul>
					</div>
				</div>
		<%	}else{ %>
				<div class="AdTracker-SortByDiv" style="display: none;">
					<div class="SortBy-List">
						<button class="SortBy-Btn icon" id="SortBy-Btn"></button>
					</div>
				</div>
		<% } %>
			
			<div id="formMod" class="modal">
				<div class="modal-content" id="modal-content">
					<div class="formTitle">
						<div class="formhead">
							<h1>Contact Seller</h1>
						</div>
						<div class="modalCloser-cont">
							<span class="modal-closer">&times </span>
						</div>
					</div>
					<div class="form">
						 <form method="" action="" style="width:95%;">
						 
							<div class="validifier-cont">
								<label for="Username" class="validifier" id="Username-Err">
								</label>
							</div>
							
							<div class="inputField-cont">
								<i class="fa fa-user ikon"></i>
								<input type="text" class="inputField-styling" id="Username" name="firstname" placeholder="Enter Your Name (Required)">
							</div>
							
							<div class="validifier-cont">
								<label for="Users-contact" class="validifier" id="contactNum-Err">
								</label>
							</div>
							
							<div class="inputField-cont">
								<i class="fa fa-phone ikon"></i>
								<input type="tel" class="inputField-styling" id="Users-contact" name="tel" placeholder="Contact Number (Optional)">
							</div>
							
							<div class="validifier-cont">
								<label for="Users-email" class="validifier" id="mailErr">
								</label>
							</div>
							
							<div class="inputField-cont">
								<i class="fa fa-envelope ikon"></i>
								<input type="email" class="inputField-styling" id="Users-email" name="email" placeholder="Email (Required)">
							</div>
							
							<div class="letter">
								<div class="validifier-cont" style="justify-content: space-between;">
									<label for="subject" id="messageLabel">Message</label>
									<label for="SubjectErrorMessage" class="validifier" id="subject-Err"></label>
								</div>
								<textarea id="subject" name="subject" placeholder="Send seller a message..."></textarea>
							</div>
							
							<input type="submit" id="submitFormInfo" value="Send Message">
						 </form>
						 
						 <div class="termPol">
							<p>By sending a reply to the seller, you accept our <a href="/terms-of-us">Terms of Use</a> and <a href="/privacy-policy">Privacy Policy</a>.</p>
						</div>
					</div>
				</div>
			</div>

			<% if(Object.keys(req.params).length === 0) { %>
			
			<% let num = 0; %>
			<% let displayAds = (adData) => { %>

			<%	let {
				Name,
				Mail,
				Tel,
				Whatsapp_tel,
				Main_Category,
				Sub_Category,
				Text_Book_Title,
				Edition_Number,
				Author_Name,
				Condition,
				Text_Book_Price,
				Negotiation,
				Description,
				Campus,
				UploadedImages
				} = adData; 
				   let img = UploadedImages[0];
				   let imgStr = img.toString().replace("C:\\Users\\J_Mosemeng\\Desktop\\Kopa-Booka\\", "\\"); 

			 num++ %>

			<% if( num <= 20){ %>
			<div class="Sellers-item">
				<div class="textBook-img">
					<img src= "<%= imgStr %>" id="img" alt="Textbook">
					<h1 class="Camera-cont">
						<i class="fa fa-camera"></i>
					<%= `+${UploadedImages.length}` %>
					</h1>
				</div>

				<div class="Ad-description">
					<h1 class="AdDescription-title"><%= Text_Book_Title %></h1>
					<p class="AdDescription-body"><%= Description %></p>
					<div class="timeAndLocation-tracker">	
						 <h3 class="location">
						   <i class="fa fa-map-marker"></i>
						<%= stringCapitalizer(UploadedImages, Campus) %>
						</h3> 
						<h3 class="time">
						   <i class="fa fa-clock"></i>
						 2 hours
						</h3> 					
					</div>
				</div>
				
				 <div class="priceAndContact-cont">
					<div class="price-cont">
						<h3 class="price-num"><%= Text_Book_Price %></h3>
					</div>
					<div class="contact-cont">
						<button class="contact-btn">
							Contact Advertiser
						</button>
					</div>
				 </div>
			</div>
			
			<div class="MobileSellers-Cont">
				<div class="MobileSellers-Card">
					<div class="MobileCard-Header">
						<h1 class="MobileCard-Title"><%= Text_Book_Title %></h1>
						<h3 class="MobileCard-Price"><%= Text_Book_Price %></h3>
					</div>
					<div class="MobileTextbook-Img">
						<img src= "<%= imgStr %>" id="Mobile-Img" alt="Textbook">
						<h1 class="MobileCamera-Cont">
							<i class="fa fa-camera"></i>
							<%= "+" + UploadedImages.length %>
						</h1>
					</div>
					<div class="MobileLocation-Cont">
						<h3 class="Mobile-location">
						   <i class="fa fa-map-marker"></i>
							<%= stringCapitalizer(UploadedImages, Campus) %>
						</h3> 
					</div>
					<div class="MobileContact-Cont">
						<button class="MobileContact-Btn">
							Contact Advertiser
						</button>
					</div>
				</div>
			</div>
		<%	}else{ %>
		<%		return false; %>
		<%	} %>
		<%	} %>

		<% result.map(displayAds); %>

		<% }else { %>
		<%	for(let i = 0, len = result.length; i < len; i++){	 %>

		<%	let { Name, Mail, Tel, Whatsapp_tel, Main_Category, Sub_Category, Text_Book_Title, Edition_Number, Author_Name, Condition, Text_Book_Price,
				Negotiation,
				Description,
				Campus,
				UploadedImages
			} = result[i]

			let textBookTileMatcher = (not) => {
				not.Text_Book_Title;
				return not.Text_Book_Title.toLowerCase().search(searchQuery.toLowerCase()) !== -1;
			} %>
			
			<% if(Boolean(result.find(textBookTileMatcher)) === true){ %>
			<%	if(result[i].Text_Book_Title.toLowerCase().search(searchQuery.toLowerCase()) !== -1){ %>
			<%	
				 let img = UploadedImages[0]; 
				 let imgStr = img.toString().replace("C:\\Users\\J_Mosemeng\\Desktop\\Kopa-Booka\\", "\\"); 

				 let arrStr = Campus.split(" "); 
				 let campusArr = []; 

				 arrStr.map((tring) => {
					tring = tring.replace("anyy", "any");
					tring = tring.replace(tring[0], tring[0].toUpperCase());
					campusArr.push(tring);
				}); %>

				<div class="Sellers-item">
					<div class="textBook-img">
						<img src= "<%= imgStr %>" id="img" alt="Textbook">
						<h1 class="Camera-cont">
							<i class="fa fa-camera"></i>
						<%= `+${UploadedImages.length}` %>
						</h1>
					</div>
					
					<div class="Ad-description">
						<h1 class="AdDescription-title"><%= Text_Book_Title %></h1>
						<p class="AdDescription-body"><%= Description %></p>
						<div class="timeAndLocation-tracker">	
							 <h3 class="location">
							   <i class="fa fa-map-marker"></i>
							<%= stringCapitalizer(UploadedImages, Campus) %>
							</h3> 
							<h3 class="time">
							   <i class="fa fa-clock"></i>
							 2 hours
							</h3> 					
						</div>
					</div>
					
					 <div class="priceAndContact-cont">
						<div class="price-cont">
							<h3 class="price-num"><%= Text_Book_Price %></h3>
						</div>
						<div class="contact-cont">
							<button class="contact-btn">
								Contact Advertiser
							</button>
						</div>
					 </div>
				</div>

				<div class="MobileSellers-Cont">
					<div class="MobileSellers-Card">
						<div class="MobileCard-Header">
							<h1 class="MobileCard-Title"><%= Text_Book_Title %></h1>
							<h3 class="MobileCard-Price"><%= Text_Book_Price %></h3>
						</div>
						<div class="MobileTextbook-Img">
							<img src= "<%= imgStr %>" id="Mobile-Img" alt="Textbook">
							<h1 class="MobileCamera-Cont">
								<i class="fa fa-camera"></i>
								<%= "+" + UploadedImages.length %>
							</h1>
						</div>
						<div class="MobileLocation-Cont">
							<h3 class="Mobile-location">
							   <i class="fa fa-map-marker"></i>
								<%= stringCapitalizer(UploadedImages, Campus) %>
							</h3> 
						</div>
						<div class="MobileContact-Cont">
							<button class="MobileContact-Btn">
								Contact Advertiser
							</button>
						</div>
					</div>
				</div>
				<%	} %>
			<%	} else { %>
				<% notFound = true %>
				<div class="messageBox-cont">
					<div class="message-box">
						<div class="messageTitle-cont">
							<i class="fa fa-search"></i>
							<h1 class="messageTitle">Couldnt find anything</h1>
						</div>

						<div class="message-cont">
							<p class="message">Sorry we couldnt find any results for "<%= `${searchQuery}` %>". Please check spelling, or try a different search.</p>
						</div>
					</div>
				</div>
				<% break; %>
			<% } %>
		<%	} %>
		<% } %>

			<% let totalAds = totalAmountOfAds;
			   let secNum = 1;
			   let remainderAdsTotal = totalAds % 20;
			   let pagininationTotal = totalAds / 20; %>

			<% if(totalAds < 20 || notFound === true){ %>
			<div class="pageNumberTracker" style="display: none;">
			</div>
			<% }else if(totalAds > 20){ %>
			<%	if(remainderAdsTotal === 0){ %>
				<div class="pageNumberTracker">
					<div class="pageNumber-cont">
						<ul class="pageNumber-list">
			<li class="pageNumber-link active"><a href="<%= req.url %>">1</a></li>
			<%		for(let i = 0; i < pagininationTotal; i++){ %>

							<li class="pageNumber-link active"><a href="<%= `${req.url}/page-${(i + 1)}` %>"><%= i + 1 %></a></li>
			<%		} %>
							<li class="pageNumber-link"><a href="<%= `${req.url}/page-${ secNum += 1 }` %>"><i class="fa fa-chevron-right"></i></a></li>
						</ul>
					</div>
				</div>
			<%	 }else if(remainderAdsTotal > 0){ %>
			<%		let addOneToTotal = parseInt(pagininationTotal) + 1; %>
					<div class="pageNumberTracker">
						<div class="pageNumber-cont">
							<ul class="pageNumber-list">
							<li class="pageNumber-link active"><a href="<%= req.url %>">1</a></li>
			<%		for(let i = 1; i < addOneToTotal; i++){ %>
								<li class="pageNumber-link"><a href="<%= `${req.url}/page-${(i + 1)}` %>"><%= i + 1 %></a></li>
			<%		} %>
								<li class="pageNumber-link"><a href="<%= `${req.url}/page-${ secNum += 1 }` %>"><i class="fa fa-chevron-right"></i></a></li>
							</ul>
						</div>
					</div>
			<%	 } %>
			<% } %>
			
		</div>
  </section>

  <footer id="foot">
		<div class="foot-info">
			<div class="logo"style="margin-left: 0.5rem;" >
				<a href="/" class="log-name bot-name" style="font-family: montserrat, sans-serif;"><i class="fa fa-book" style="font-size: 1.5rem;  padding: 8px;"></i>Kopa Booka</a>
			</div>

			<div class="foot-content">
				<div class="foot-web">
					<h1><a href="/Privacy-Policy/Privacy-HTML/Privacy Policy.html" class="foot-link" >Privacy Policy</a></h1>
					<h1><a href="/Terms-of-Use/Terms-of-Use-HTML/Terms of Use.html" class="foot-link">Terms of Use</a></h1>
					<h1><a href="#" class="foot-link">Browser Support</a></h1>
				</div>
				
				<div class="mobileLogo">
					<a href="/" class="log-name bot-name" style="font-family: montserrat, sans-serif;"><i class="fa fa-book" style="font-size: 1.5rem;  padding: 8px;"></i>Kopa Booka</a>
				</div>
			
				<div class="footMobile-web">
					<div class="footMobileWeb-title" id="btn">
						<span class="footMobile-title" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Our policies</span>
						<i class="fa fa-caret-up arrowDown flip-up" id="arrow"></i>
					</div>
					<ul class="footMobile-list">
						<li><a href="/Privacy-Policy/Privacy-HTML/Privacy Policy.html" class="footMobileWeb-link" >Privacy Policy</a></li>
						<li><a href="/Terms-of-Use/Terms-of-Use-HTML/Terms of Use.html" class="footMobileWeb-link">Terms of Use</a></li>
						<li><a href="#" class="footMobileWeb-link">Browser Support</a></li>
					</ul>
				</div>
				
				<div class="foot-title">
					<h1>&copy;2020 DESIGNED BY: <a href="http://juniormosemeng.000webhostapp.com/" target="_blank">MONOAMETSI</a></h1>
				</div>
			</div>

			<div class="shooter" >
				<i class="fa fa-chevron-up shoot" id="scrollTopper"></i>
			</div>
		</div>
	</footer>

  <script src="/Advertisement-JS/Book Ad.js"></script>
  <script src="/Advertisement-JS/formValidation.js"></script>
</body>
</html>